<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>전기차에 관심이 있는 당신에게...</title>
    <style>
        #mapwrap {
            position: relative;
            overflow: hidden;
        }

        .category,
        .category * {
            margin: 0;
            padding: 0;
            color: #000;
        }

        .category {
            position: absolute;
            overflow: hidden;
            top: 10px;
            left: 10px;
            width: 150px;
            height: 50px;
            z-index: 10;
            border: 1px solid black;
            font-family: 'Malgun Gothic', '맑은 고딕', sans-serif;
            font-size: 12px;
            text-align: center;
            background-color: #fff;
        }

        .category .menu_selected {
            background: #FF5F4A;
            ;
            color: #fff;
            border-left: 1px solid #915B2F;
            border-right: 1px solid #915B2F;
            margin: 0 -1px;
        }

        .category li {
            list-style: none;
            float: left;
            width: 50px;
            height: 45px;
            padding-top: 5px;
            cursor: pointer;
        }

        .category .ico_comm {
            display: block;
            margin: 0 auto 2px;
            width: 35px;
            height: 22px;
            background: url('/image/category.png') no-repeat;
        }

        .category .ico_fast {
            background-position: -1px 0;
        }

        .category .ico_slow {
            background-position: -1px -36px;
        }

        .category .ico_both {
            background-position: -1px -72px;
        }
    </style>
</head>

<body>
    <div id="mapwrap">
        <!-- 지도가 표시될 div -->
        <div id="map" style="width:500px;height:500px;"></div>
        <!-- 지도 위에 표시될 마커 카테고리 -->
        <div class="category">
            <ul>
                <li id="fastMenu" onclick="changeMarker('fast')">
                    <span class="ico_comm ico_fast"></span>
                    급속
                </li>
                <li id="slowMenu" onclick="changeMarker('slow')">
                    <span class="ico_comm ico_slow"></span>
                    완속
                </li>
                <li id="bothMenu" onclick="changeMarker('both')">
                    <span class="ico_comm ico_both"></span>
                    모두보기
                </li>
            </ul>
        </div>
    </div>

    <script type="text/javascript"
        src="//dapi.kakao.com/v2/maps/sdk.js?appkey=45321f1a3cbd1d0347edb6706e6095b7"></script>
    <script src="//code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="Map.js"></script>
    <!-- <script>
        var mapContainer = document.getElementById('map'), // 지도를 표시할 div  
            mapOption = {
                center: new kakao.maps.LatLng(37.61972782200497, 127.06089191076839), // 지도의 중심좌표 
                level: 3 // 지도의 확대 레벨 
            };
        var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다

        readTextFile1('fast.json')
        readTextFile2('slow.json')
        readTextFile3('EV_Charging_Station_Information.json')


        var markerImageSrc = 'category_icon1.png';  // 마커이미지의 주소입니다. 스프라이트 이미지 입니다
        fastMarkers = [], // 급속 마커 객체를 가지고 있을 배열입니다
            slowMarkers = [], // 완속 마커 객체를 가지고 있을 배열입니다
            bothMarkers = []; // 혼합 마커 객체를 가지고 있을 배열입니다

        changeMarker('fast'); // 지도에 급속 마커가 보이도록 설정합니다    

        function readTextFile1(file) {
            var rawFile = new XMLHttpRequest();
            rawFile.open("GET", file);
            rawFile.onreadystatechange = function () {
                if (rawFile.readyState === 4) {
                    if (rawFile.status === 200 || rawFile.status == 0) {
                        var allText = rawFile.responseText;
                        createfastMarkers(eval(allText)); // 급속 마커를 생성하고 급속 마커 배열에 추가합니다
                    }
                }
            }
            rawFile.send(null);
        }

        function readTextFile2(file) {
            var rawFile = new XMLHttpRequest();
            rawFile.open("GET", file);
            rawFile.onreadystatechange = function () {
                if (rawFile.readyState === 4) {
                    if (rawFile.status === 200 || rawFile.status == 0) {
                        var allText = rawFile.responseText;
                        createslowMarkers(eval(allText)); // 완속 마커를 생성하고 완속 마커 배열에 추가합니다
                    }
                }
            }
            rawFile.send(null);
        }

        function readTextFile3(file) {
            var rawFile = new XMLHttpRequest();
            rawFile.open("GET", file);
            rawFile.onreadystatechange = function () {
                if (rawFile.readyState === 4) {
                    if (rawFile.status === 200 || rawFile.status == 0) {
                        var allText = rawFile.responseText;
                        createbothMarkers(eval(allText)); // 혼합 마커를 생성하고 혼합 마커 배열에 추가합니다
                    }
                }
            }
            rawFile.send(null);
        }


        // 마커이미지의 주소와, 크기, 옵션으로 마커 이미지를 생성하여 리턴하는 함수입니다
        function createMarkerImage(src, size, options) {
            var markerImage = new kakao.maps.MarkerImage(src, size, options);
            return markerImage;
        }

        // 좌표와 마커이미지를 받아 마커를 생성하여 리턴하는 함수입니다
        function createMarker(position, image) {
            var marker = new kakao.maps.Marker({
                position: position,
                image: image
            });

            return marker;
        }

        // 급속 마커를 생성하고 급속 마커 배열에 추가하는 함수입니다
        function createfastMarkers(data) {
            // for (var i = 0; i < data.length; i++) {

            //     var imageSize = new kakao.maps.Size(22, 26),
            //         imageOptions = {
            //             spriteOrigin: new kakao.maps.Point(10, 0),
            //             spriteSize: new kakao.maps.Size(36, 98)
            //         };

            //     var infowindow = new kakao.maps.InfoWindow({
            //         content: '<div>' + data[i].Place + '<div>', // 인포윈도우에 표시할 내용
            //     });

            //     var latloninfo = new kakao.maps.LatLng(dat[i].Lat,dat[i].Lon);

            //     // 마커이미지와 마커를 생성합니다
            //     var markerImage = createMarkerImage(markerImageSrc, imageSize, imageOptions),
            //         marker = createMarker(latloninfo, markerImage);
                

            //     kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infowindow));
            //     kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(infowindow));

            //     // 생성된 마커를 급속 마커 배열에 추가합니다
            //     fastMarkers.push(marker);
            // }

            data.forEach((element,i) => {
                var imageSize = new kakao.maps.Size(22, 26),
                    imageOptions = {
                        spriteOrigin: new kakao.maps.Point(10, 0),
                        spriteSize: new kakao.maps.Size(36, 98)
                    };

                var infowindow = new kakao.maps.InfoWindow({
                    content: '<div>' + element.Place + '<br>' + '급속 충전기 : '+ element.Fast + '<br>' + '완속 충전기 : ' +element.Slow +'<div>', // 인포윈도우에 표시할 내용
                });

                var latloninfo = new kakao.maps.LatLng(element.Lat,element.Lon);

                // 마커이미지와 마커를 생성합니다
                var markerImage = createMarkerImage(markerImageSrc, imageSize, imageOptions),
                    marker = createMarker(latloninfo, markerImage);
                

                kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infowindow));
                kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(infowindow));

                // 생성된 마커를 급속 마커 배열에 추가합니다
                fastMarkers.push(marker);
            });


        }

        // 급속 마커들의 지도 표시 여부를 설정하는 함수입니다
        function setfastMarkers(map) {
            for (var i = 0; i < fastMarkers.length; i++) {
                fastMarkers[i].setMap(map);
            }
        }

        // 완속 마커를 생성하고 완속 마커 배열에 추가하는 함수입니다
        function createslowMarkers(data) {
            // for (var i = 0; i < data.length; i++) {

            //     var imageSize = new kakao.maps.Size(22, 26),
            //         imageOptions = {
            //             spriteOrigin: new kakao.maps.Point(10, 0),
            //             spriteSize: new kakao.maps.Size(36, 98)
            //         };

            //     var infowindow = new kakao.maps.InfoWindow({
            //         content: '<div>' + data[i].Place + '<div>' // 인포윈도우에 표시할 내용
            //     });

            //     var latloninfo = new kakao.map.LatLng(data[i].Lat, data[i].Lon);

            //     // 마커이미지와 마커를 생성합니다
            //     var markerImage = createMarkerImage(markerImageSrc, imageSize, imageOptions),
            //         marker = createMarker(latloninfo, markerImage);


            //     kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infowindow));
            //     kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(infowindow));

            //     // 생성된 마커를 완속 마커 배열에 추가합니다
            //     slowMarkers.push(marker);
            // }

            data.forEach((element,i) => {
                var imageSize = new kakao.maps.Size(22, 26),
                    imageOptions = {
                        spriteOrigin: new kakao.maps.Point(10, 36),
                        spriteSize: new kakao.maps.Size(36, 98)
                    };

                var infowindow = new kakao.maps.InfoWindow({
                    content: '<div>' + element.Place + '<br>' + '급속 충전기 : '+ element.Fast + '<br>' + '완속 충전기 : ' +element.Slow +'<div>', // 인포윈도우에 표시할 내용
                });

                var latloninfo = new kakao.maps.LatLng(element.Lat,element.Lon);

                // 마커이미지와 마커를 생성합니다
                var markerImage = createMarkerImage(markerImageSrc, imageSize, imageOptions),
                    marker = createMarker(latloninfo, markerImage);
                

                kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infowindow));
                kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(infowindow));

                // 생성된 마커를 급속 마커 배열에 추가합니다
                slowMarkers.push(marker);
            });
        }

        // 완속 마커들의 지도 표시 여부를 설정하는 함수입니다
        function setslowMarkers(map) {
            for (var i = 0; i < slowMarkers.length; i++) {
                slowMarkers[i].setMap(map);
            }
        }

        // 혼합 마커를 생성하고 혼합 마커 배열에 추가하는 함수입니다
        function createbothMarkers(data) {
            // for (var i = 0; i < data.length; i++) {

            //     var imageSize = new kakao.maps.Size(22, 26),
            //         imageOptions = {
            //             spriteOrigin: new kakao.maps.Point(10, 0),
            //             spriteSize: new kakao.maps.Size(36, 98)
            //         };


            //     var infowindow = new kakao.maps.InfoWindow({
            //         content: '<div>' + data[i].Place + '<div>' // 인포윈도우에 표시할 내용
            //     });

            //     var latloninfo = new kakao.map.LatLng(data[i].Lat, data[i].Lon);

            //     // 마커이미지와 마커를 생성합니다
            //     var markerImage = createMarkerImage(markerImageSrc, imageSize, imageOptions),
            //         marker = createMarker(latloninfo, markerImage);


            //     kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infowindow));
            //     kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(infowindow));

            //     // 생성된 마커를 급속 마커 배열에 추가합니다
            //     bothMarkers.push(marker);
            // }

            data.forEach((element,i) => {
                var imageSize = new kakao.maps.Size(22, 26),
                    imageOptions = {
                        spriteOrigin: new kakao.maps.Point(10, 72),
                        spriteSize: new kakao.maps.Size(36, 98)
                    };

                var infowindow = new kakao.maps.InfoWindow({
                    content: '<div>' + element.Place + '<br>' + '급속 충전기 : '+ element.Fast + '<br>' + '완속 충전기 : ' +element.Slow +'<div>', // 인포윈도우에 표시할 내용
                });

                var latloninfo = new kakao.maps.LatLng(element.Lat,element.Lon);

                // 마커이미지와 마커를 생성합니다
                var markerImage = createMarkerImage(markerImageSrc, imageSize, imageOptions),
                    marker = createMarker(latloninfo, markerImage);
                

                kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infowindow));
                kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(infowindow));

                // 생성된 마커를 급속 마커 배열에 추가합니다
                bothMarkers.push(marker);
            });
        }

        // 혼합 마커들의 지도 표시 여부를 설정하는 함수입니다
        function setbothMarkers(map) {
            for (var i = 0; i < bothMarkers.length; i++) {
                bothMarkers[i].setMap(map);
            }
        }

        function makeOverListener(map, marker, infowindow) {
            return function () {
                infowindow.open(map, marker);
            };
        }

        // 인포윈도우를 닫는 클로저를 만드는 함수입니다 
        function makeOutListener(infowindow) {
            return function () {
                infowindow.close();
            };
        }

        // 카테고리를 클릭했을 때 type에 따라 카테고리의 스타일과 지도에 표시되는 마커를 변경합니다
        function changeMarker(type) {

            var fastMenu = document.getElementById('fastMenu');
            var slowMenu = document.getElementById('slowMenu');
            var bothMenu = document.getElementById('bothMenu');

            // 급속 카테고리가 클릭됐을 때
            if (type === 'fast') {

                // 급속 카테고리를 선택된 스타일로 변경하고
                fastMenu.className = 'menu_selected';

                // 완속과 혼합 카테고리는 선택되지 않은 스타일로 바꿉니다
                slowMenu.className = '';
                bothMenu.className = '';

                // 급속 마커들만 지도에 표시하도록 설정합니다
                setfastMarkers(map);
                setslowMarkers(null);
                setbothMarkers(null);

            } else if (type === 'slow') { // 완속 카테고리가 클릭됐을 때

                // 완속 카테고리를 선택된 스타일로 변경하고
                fastMenu.className = '';
                slowMenu.className = 'menu_selected';
                bothMenu.className = '';

                // 완속 마커들만 지도에 표시하도록 설정합니다
                setfastMarkers(null);
                setslowMarkers(map);
                setbothMarkers(null);

            } else if (type === 'both') { // 혼합 카테고리가 클릭됐을 때

                // 혼합 카테고리를 선택된 스타일로 변경하고
                fastMenu.className = '';
                slowMenu.className = '';
                bothMenu.className = 'menu_selected';

                // 혼합 마커들만 지도에 표시하도록 설정합니다
                setfastMarkers(null);
                setslowMarkers(null);
                setbothMarkers(map);
            }
        }
    </script> -->
</body>

</html>